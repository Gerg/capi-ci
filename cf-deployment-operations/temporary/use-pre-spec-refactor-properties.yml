---
- type: replace
  path: /instance_groups/name=uaa/jobs/name=uaa/properties/uaa/clients/tcp_router?
  value:
    authorities: routing.routes.read
    authorized-grant-types: client_credentials
    secret: "((uaa_clients_tcp_router_secret))"
- type: replace
  path: /instance_groups/name=api/jobs/name=cloud_controller_ng/properties/hm9000?/port
  value: -1
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/hm9000?/port
  value: -1
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/cc/default_running_security_groups?
  value: &cc_default_running_security_groups
    - public_networks
    - dns
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/cc/default_staging_security_groups?
  value: &cc_default_staging_security_groups
    - public_networks
    - dns
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/cc/security_group_definitions?
  value: &cc_security_group_definitions
    - name: public_networks
      rules:
      - destination: 0.0.0.0-9.255.255.255
        protocol: all
      - destination: 11.0.0.0-169.253.255.255
        protocol: all
      - destination: 169.255.0.0-172.15.255.255
        protocol: all
      - destination: 172.32.0.0-192.167.255.255
        protocol: all
      - destination: 192.169.0.0-255.255.255.255
        protocol: all
    - name: dns
      rules:
      - destination: 0.0.0.0/0
        ports: '53'
        protocol: tcp
      - destination: 0.0.0.0/0
        ports: '53'
        protocol: udp
- type: remove
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/cc/install_buildpacks
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/cc/bulk_api_password?
  value: "((cc_bulk_api_password))"
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/cc/quota_definitions?
  value: &quota_definitions
    default:
      memory_limit: 102400
      non_basic_services_allowed: true
      total_routes: 1000
      total_services: -1
      total_reserved_route_ports: 100
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/app_domains?
  value: &app_domains
    - "((system_domain))"
- type: replace
  path: /instance_groups/name=cc-worker/jobs/name=cloud_controller_worker/properties/uaa/url?
  value: https://uaa.((system_domain))
- type: replace
  path: /instance_groups/name=tcp-router?
  value:
    azs:
    - z1
    - z2
    instances: 2
    vm_type: minimal
    stemcell: default
    vm_extensions:
    - cf-tcp-router-network-properties
    networks:
    - name: default
    jobs:
    - name: consul_agent
      release: consul
      consumes:
        consul_common: {from: consul_common_link}
        consul_server: nil
        consul_client: {from: consul_client_link}
    - name: tcp_router
      release: routing
      properties:
        tcp_router:
          oauth_secret: "((uaa_clients_tcp_router_secret))"
          router_group: default-tcp
        uaa:
          ca_cert: "((uaa_ca.certificate))"
          tls_port: 8443
    - name: metron_agent
      release: loggregator
      properties: &metron_agent_properties
        metron_agent:
          deployment: "((system_domain))"
        metron_endpoint:
          shared_secret: "((dropsonde_shared_secret))"
        loggregator:
          tls:
            ca_cert: "((loggregator_tls_metron.ca))"
            metron:
              cert: "((loggregator_tls_metron.certificate))"
              key: "((loggregator_tls_metron.private_key))"
- type: replace
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/hm9000?/port
  value: -1
- type: replace
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/cc/default_running_security_groups?
  value: *cc_default_running_security_groups
- type: replace
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/cc/default_staging_security_groups?
  value: *cc_default_staging_security_groups
- type: remove
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/cc/install_buildpacks
- type: replace
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/cc/bulk_api_password?
  value: "((cc_bulk_api_password))"
- type: replace
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/cc/quota_definitions?
  value: *quota_definitions
- type: replace
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/app_domains?
  value: *app_domains
- type:
  path: /instance_groups/name=scheduler/jobs/name=cloud_controller_clock/properties/uaa/url?
  value: https://uaa.((system_domain))
- type: replace
  path: /variables/name=uaa_clients_tcp_router_secret?/type
  value: password
